<xml xmlns="https://developers.google.com/blockly/xml"><variables></variables><block type="pxt-on-start" x="10" y="10"><statement name="HANDLER"><block type="typescript_statement"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum Color {" line1="    Red," line2="    Yellow," line3="    Green" line4="}" numlines="5"></mutation><next><block type="typescript_statement"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum State {" line1="    On," line2="    Off" line3="}" numlines="4"></mutation><next><block type="typescript_statement"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum Dir {" line1="    Up = 0," line2="    Down = 4," line3="    Right = 2," line4="    Left = 6" line5="}" numlines="6"></mutation><next><block type="typescript_statement"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace FirstProjects {" line1="    //% blockId=&quot;semaphore_create&quot; block=&quot;Semaphore at pin %pin|with %direction|direction&quot;" line2="    //% blockSetVariable=semaphore" line3="    //% weight=100" line4="    //% subcategory=Semaphore" line5="    export function create(pin: PlanetX_Display.DigitalRJPin, direction: Dir): Semaphore {" line6="        let sem = new Semaphore();" line7="        sem.strip = PlanetX_Display.create(pin, 8, PlanetX_Display.NeoPixelMode.RGB)" line8="        sem.direction = direction;" line9="        sem.status_red = false" line10="        sem.status_yellow = false" line11="        sem.status_green = false" line12="        return sem;" line13="    }" line14="" line15="    export class Semaphore {" line16="        strip: PlanetX_Display.Strip;" line17="        direction: Dir;" line18="        status_red: boolean" line19="        status_yellow: boolean" line20="        status_green: boolean" line21="" line22="" line23="        //% blockId=&quot;semaphore_set&quot; block=&quot;Set %semaphore %color to %state&quot; subcategory=Semaphore" line24="        set(color: Color, state: State) {" line25="            switch (color) {" line26="                case Color.Red:" line27="                    this.status_red = (state == State.On)" line28="                    break;" line29="                case Color.Yellow:" line30="                    this.status_yellow = (state == State.On)" line31="                    break;" line32="                case Color.Green:" line33="                    this.status_green = (state == State.On)" line34="                    break;" line35="            }" line36="            this.redraw()" line37="        }" line38="" line39="        //% blockId=&quot;semaphore_clear&quot; block=&quot;Clear %semaphore&quot; subcategory=Semaphore" line40="        clear() {" line41="            this.status_red = false" line42="            this.status_yellow = false" line43="            this.status_green = false" line44="            this.redraw()" line45="        }" line46="" line47="        private redraw() {" line48="            this.strip.clear()" line49="" line50="            if (this.status_red) {" line51="                this.strip.setPixelColor(getLed(7, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Red))" line52="                this.strip.setPixelColor(getLed(6, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Red))" line53="                this.strip.setPixelColor(getLed(5, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Red))" line54="            }" line55="            if (this.status_yellow) {" line56="                this.strip.setPixelColor(getLed(0, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Yellow))" line57="                this.strip.setPixelColor(getLed(4, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Yellow))" line58="            }" line59="            if (this.status_green) {" line60="                this.strip.setPixelColor(getLed(1, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Green))" line61="                this.strip.setPixelColor(getLed(2, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Green))" line62="                this.strip.setPixelColor(getLed(3, this.direction), PlanetX_Display.colors(PlanetX_Display.NeoPixelColors.Green))" line63="            }" line64="            this.strip.show()" line65="        }" line66="    }" line67="" line68="    function getLed(position: number, direction: Dir): number {" line69="        return (position + direction) % 8" line70="    }" line71="}" numlines="72"></mutation></block></next></block></next></block></next></block></statement></block></xml>